/*! For license information please see web-client.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MoveoAI=t():e.MoveoAI=t()}(self,(function(){return function(){var e={9477:function(e,t,n){"use strict";var o=n(5516),i=n.n(o),r=n(1364),s=n.n(r)()(i());s.push([e.id,".web-client-container{position:fixed;bottom:0;right:0;cursor:pointer;z-index:10022;max-height:99%}.web-client-container.embed{position:static;width:100% !important;height:100% !important}.web-client-container.full{width:100% !important;height:100% !important;inset:0 !important;max-height:initial}","",{version:3,sources:["webpack://./src/styles/web-client.scss"],names:[],mappings:"AAIA,sBAIE,cAAA,CACA,QAAA,CACA,OAAA,CACA,cAAA,CACA,aAPiB,CAQjB,cAPoB,CASpB,4BACE,eAAA,CACA,qBAAA,CACA,sBAAA,CAIF,2BACE,qBAAA,CACA,sBAAA,CACA,kBAAA,CACA,kBAAA",sourcesContent:["// This style is applied to the iframe that customers load.\n// Ideally we use style variables rather than this so that\n// we can use the widget-id.\n\n.web-client-container {\n  $widget-z-index: 10022;\n  $widget-max-height: 99%;\n\n  position: fixed;\n  bottom: 0;\n  right: 0;\n  cursor: pointer;\n  z-index: $widget-z-index;\n  max-height: $widget-max-height;\n\n  &.embed {\n    position: static;\n    width: 100% !important;\n    height: 100% !important;\n  }\n\n  // ! Important because this happens on the clients website\n  &.full {\n    width: 100% !important;\n    height: 100% !important;\n    inset: 0 !important;\n    max-height: initial;\n  }\n}\n"],sourceRoot:""}]),t.A=s},1364:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,i,r){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(o)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var d=0;d<e.length;d++){var u=[].concat(e[d]);o&&s[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=r),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},5516:function(e){"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),r="/*# ".concat(i," */");return[t].concat([r]).join("\n")}return[t].join("\n")}},1931:function(e,t,n){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let o=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(o++,"%c"===e&&(i=o))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(4582)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},4582:function(e,t,n){e.exports=function(e){function t(e){let n,i,r,s=null;function a(...e){if(!a.enabled)return;const o=a,i=Number(new Date),r=i-(n||i);o.diff=r,o.prev=n,o.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";s++;const r=t.formatters[i];if("function"==typeof r){const t=e[s];n=r.call(o,t),e.splice(s,1),s--}return n})),t.formatArgs.call(o,e),(o.log||t.log).apply(o,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=o,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,r=t.enabled(e)),r),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function o(e,n){const o=t(this.namespace+(void 0===n?":":n)+e);return o.log=this.log,o}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const o=("string"==typeof e?e:"").split(/[\s,]+/),i=o.length;for(n=0;n<i;n++)o[n]&&("-"===(e=o[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,o;for(n=0,o=t.skips.length;n<o;n++)if(t.skips[n].test(e))return!1;for(n=0,o=t.names.length;n<o;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(6151),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},7967:function(e,t,n){var o=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),l=Object.prototype.toString,f=Math.max,p=Math.min,m=function(){return u.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==l.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=r.test(e);return n||s.test(e)?a(e.slice(2),n?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var o,i,r,s,a,c,d=0,u=!1,l=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=o,r=i;return o=i=void 0,d=t,s=e.apply(r,n)}function w(e){var n=e-c;return void 0===c||n>=t||n<0||l&&e-d>=r}function b(){var e=m();if(w(e))return C(e);a=setTimeout(b,function(e){var n=t-(e-c);return l?p(n,r-(e-d)):n}(e))}function C(e){return a=void 0,v&&o?y(e):(o=i=void 0,s)}function A(){var e=m(),n=w(e);if(o=arguments,i=this,c=e,n){if(void 0===a)return function(e){return d=e,a=setTimeout(b,t),u?y(e):s}(c);if(l)return a=setTimeout(b,t),y(c)}return void 0===a&&(a=setTimeout(b,t)),s}return t=g(t)||0,h(n)&&(u=!!n.leading,r=(l="maxWait"in n)?f(g(n.maxWait)||0,t):r,v="trailing"in n?!!n.trailing:v),A.cancel=function(){void 0!==a&&clearTimeout(a),d=0,o=c=i=a=void 0},A.flush=function(){return void 0===a?s:C(m())},A}},9572:function(e,t,n){var o="Expected a function",i=NaN,r="[object Symbol]",s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,d=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,f="object"==typeof self&&self&&self.Object===Object&&self,p=l||f||Function("return this")(),m=Object.prototype.toString,h=Math.max,g=Math.min,v=function(){return p.Date.now()};function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&m.call(e)==r}(e))return i;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=c.test(e);return n||d.test(e)?u(e.slice(2),n?2:8):a.test(e)?i:+e}e.exports=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(o);return y(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),function(e,t,n){var i,r,s,a,c,d,u=0,l=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError(o);function m(t){var n=i,o=r;return i=r=void 0,u=t,a=e.apply(o,n)}function b(e){var n=e-d;return void 0===d||n>=t||n<0||f&&e-u>=s}function C(){var e=v();if(b(e))return A(e);c=setTimeout(C,function(e){var n=t-(e-d);return f?g(n,s-(e-u)):n}(e))}function A(e){return c=void 0,p&&i?m(e):(i=r=void 0,a)}function x(){var e=v(),n=b(e);if(i=arguments,r=this,d=e,n){if(void 0===c)return function(e){return u=e,c=setTimeout(C,t),l?m(e):a}(d);if(f)return c=setTimeout(C,t),m(d)}return void 0===c&&(c=setTimeout(C,t)),a}return t=w(t)||0,y(n)&&(l=!!n.leading,s=(f="maxWait"in n)?h(w(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),x.cancel=function(){void 0!==c&&clearTimeout(c),u=0,i=d=r=c=void 0},x.flush=function(){return void 0===c?a:A(v())},x}(e,t,{leading:i,maxWait:t,trailing:r})}},6151:function(e){var t=1e3,n=60*t,o=60*n,i=24*o;function r(e,t,n,o){var i=t>=1.5*n;return Math.round(e/n)+" "+o+(i?"s":"")}e.exports=function(e,s){s=s||{};var a,c,d=typeof e;if("string"===d&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var s=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===d&&isFinite(e))return s.long?(a=e,(c=Math.abs(a))>=i?r(a,c,i,"day"):c>=o?r(a,c,o,"hour"):c>=n?r(a,c,n,"minute"):c>=t?r(a,c,t,"second"):a+" ms"):function(e){var r=Math.abs(e);return r>=i?Math.round(e/i)+"d":r>=o?Math.round(e/o)+"h":r>=n?Math.round(e/n)+"m":r>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6186:function(e){"use strict";var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var r={},s=[],a=0;a<e.length;a++){var c=e[a],d=o.base?c[0]+o.base:c[0],u=r[d]||0,l="".concat(d," ").concat(u);r[d]=u+1;var f=n(l),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var m=i(p,o);o.byIndex=a,t.splice(a,0,{identifier:l,updater:m,references:1})}s.push(l)}return s}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var r=o(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<r.length;s++){var a=n(r[s]);t[a].references--}for(var c=o(e,i),d=0;d<r.length;d++){var u=n(r[d]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}r=c}}},7433:function(e){"use strict";var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},8990:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},8626:function(e,t,n){"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},2155:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,i&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},9827:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,n),r.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var o={};return function(){"use strict";n.r(o),n.d(o,{init:function(){return B}});var e=n(1931),t=n.n(e);const i=e=>{if("object"==typeof e&&null!==e){if("function"==typeof Object.getPrototypeOf){const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}return"[object Object]"===Object.prototype.toString.call(e)}return!1},r=(...e)=>e.reduce(((e,t)=>{if(Array.isArray(t))throw new TypeError("Arguments provided to ts-deepmerge must be objects, not arrays.");return Object.keys(t).forEach((n=>{["__proto__","constructor","prototype"].includes(n)||(Array.isArray(e[n])&&Array.isArray(t[n])?e[n]=r.options.mergeArrays?r.options.uniqueArrayItems?Array.from(new Set(e[n].concat(t[n]))):[...e[n],...t[n]]:t[n]:i(e[n])&&i(t[n])?e[n]=r(e[n],t[n]):e[n]=void 0===t[n]?r.options.allowUndefinedOverrides?t[n]:e[n]:t[n])})),e}),{}),s={allowUndefinedOverrides:!0,mergeArrays:!0,uniqueArrayItems:!0};r.options=s,r.withOptions=(e,...t)=>{r.options=Object.assign(Object.assign({},s),e);const n=r(...t);return r.options=s,n};var a=r;const c="https://channels-ws.moveo.ai",d="https://web-client.dev.moveo.ai",u=()=>window.innerWidth<650||window.innerHeight<550&&window.innerWidth<1e3,l=(e,t)=>{var n,o;const i=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.type;return"string"==typeof i&&i.startsWith(e)?{type:i.replace(e,""),data:null===(o=t.data)||void 0===o?void 0:o.data}:null};var f,p,m,h,g,v,y=/bot|spider|crawl|http|lighthouse/i,w=n(7967),b=n.n(w),C=n(9572),A=n.n(C);!function(e){e.Open="open",e.Resolved="closed",e.Expired="expired",e.Spam="spam",e.Trash="trash"}(p||(p={})),function(e){e.IframeLoaded="moveo-iframe-loaded",e.IframeError="moveo-iframe-error",e.WidgetLoaded="moveo-widget-loaded",e.WidgetError="moveo-widget-error",e.Opened="moveo-widget-opened",e.Closed="moveo-widget-closed",e.Resize="moveo-widget-resize",e.LocaleChanged="moveo-widget-locale-changed",e.SessionCreated="moveo-widget-session-created",e.SessionReconnected="moveo-widget-session-reconnected",e.SessionClosed="moveo-widget-session-closed",e.ConversationClosed="moveo-widget-conversation-closed",e.ConversationUnreadMessages="moveo-conversation-unread-messages",e.ConversationNoUnreadMessages="moveo-conversation-no-unread-messages",e.UserWayInit="moveo-userway-init"}(m||(m={})),function(e){e.SetConfig="moveo-set-config",e.SetLocale="moveo-set-locale",e.SetCssVariables="moveo-set-css-variables",e.Open="moveo-open",e.Close="moveo-close",e.SendMessage="moveo-send-message",e.UpdateContext="moveo-update-context",e.WindowResize="moveo-resize",e.SessionActivity="session-activity",e.UserWayDisabled="userway-disabled",e.UserWayEnabled="userway-enabled"}(h||(h={})),function(e){e.Expired="expired",e.Survey="survey",e.SurveyFull="survey-full",e.Closing="closing",e.Resolved="closed",e.Inactivity="inactivity"}(g||(g={})),function(e){e.MinimizeButton="minimize-btn",e.CloseButton="close-btn",e.EndSessionButton="end-btn",e.LauncherButton="launcher-btn",e.MessageInput="message-input",e.DisclaimerCheck="disclaimer-check",e.DisclaimerContainer="disclaimer-container",e.HeaderContainer="header-container",e.ImageButton="image-btn"}(v||(v={}));const x=["s2","s3","s4","s6","s7","s10","s12","s13","s14","s15","s16","s17","s19","s23"];class F{constructor(e){this.detectUserway=()=>{x.forEach((e=>{document.addEventListener(`userway:feature_enabled_${e}`,(()=>{var t;const n=null!==(t=localStorage.getItem(`userway-${e}`))&&void 0!==t?t:"";this.sendEventToIframe({type:h.UserWayEnabled,data:{eventType:e,value:n}})})),document.addEventListener(`userway:feature_disabled_${e}`,(()=>{this.sendEventToIframe({type:h.UserWayDisabled,data:{eventType:e}})}))}))},this.initUserway=()=>{const e=Object.assign({},localStorage);Object.keys(e).forEach((t=>{const n=(e[t],e[t]);if(t.includes("userway-s")&&(!isNaN(parseInt(n))||"true"===n)){const e=t.split("-")[1];"0"===n?this.sendEventToIframe({type:h.UserWayDisabled,data:{eventType:e}}):this.sendEventToIframe({type:h.UserWayEnabled,data:{eventType:e,value:n}})}}))},this.detectMobile=()=>{this.sendEventToIframe({type:h.WindowResize,data:{is_mobile:u(),width:window.innerWidth,height:window.innerHeight}}),this.isMobile=u()},this.trackActivity=()=>{const e=A()((()=>{this.sendEventToIframe({type:h.SessionActivity,data:"active"})}),3e3);window.onload=e,window.onmousemove=e,window.onmousedown=e,window.ontouchstart=e,window.ontouchmove=e,window.onclick=e,window.onkeydown=e,window.addEventListener("scroll",e,!0)},this.config=e,this.id=e.widgetId,this.initialized=!1,this.log=t()(`moveo:web-client:${this.id}`),this.iframe=this.createIframe(),this.isMobile=null}createIframe(){const e=document.createElement("iframe");return e.width="1px",e.height="1px",e.title="Moveo webchat",e.id=this.id,e.name=this.id,e.allow="geolocation",e.style.border="0",e.classList.add("web-client-container"),"embed"===this.config.widget_position&&e.classList.add("embed"),e.setAttribute("src",(e=>{let t="";const n=document.querySelectorAll("script"),o=/@moveo-ai\/web-client.*next/;n&&n.forEach((e=>{var n;(null===(n=e.src)||void 0===n?void 0:n.match(o))&&(t=d)}));const{origin:i}=window.location;return t||(t=i.match(/localhost:8880/)||i.match(/web-client.*moveo-ai\.vercel\.app/)?i:i.match(/web-client\.dev/)?d:"https://web-client.moveo.ai"),`${t}?widgetId=${e}`})(this.id)),e}handleEvents(e,t){return n=>{const o=l(this.id,n);if(o)switch(o.type){case m.IframeLoaded:this.sendEventToIframe({type:h.SetConfig,data:this.config});break;case m.IframeError:return t(o.data);case m.UserWayInit:this.initUserway(),this.detectUserway();case m.WidgetLoaded:setTimeout((()=>{this.detectMobile(),e(this)}),0);break;case m.WidgetError:this.notify(o);break;case m.Opened:(o.data.isFull||o.data.is_mobile)&&this.iframe.classList.add("full");break;case m.Closed:o.data.isFull&&this.iframe.classList.remove("full");break;case m.Resize:this.iframe.style.width=o.data.width,this.iframe.style.height=o.data.height,this.iframe.style.left=o.data.left;break;default:this.log(`Unhandle event: ${o.type}`)}}}init(){return new Promise(((e,t)=>{var n,o;if(function(e){if(void 0===f)try{f=new RegExp(" daum[ /]| deusu/| yadirectfetcher|(?:^| )site|(?:^|[^g])news|(?<! (?:channel/|google/))google(?!(app|/google| pixel))|(?<! cu)bot(?:[^\\w]|_|$)|(?<! ya(?:yandex)?)search|(?<!(?:lib))http|(?<![hg]m)score|@[a-z]|\\(at\\)[a-z]|\\[at\\][a-z]|^12345|^<|^[\\w \\.\\-\\(?:\\):]+(?:/v?\\d+(\\.\\d+)?(?:\\.\\d{1,10})?)?(?:,|$)|^[^ ]{50,}$|^active|^ad muncher|^amaya|^anglesharp/|^avsdevicesdk/|^bidtellect/|^biglotron|^bot|^btwebclient/|^clamav[ /]|^client/|^cobweb/|^coccoc|^custom|^ddg[_-]android|^discourse|^dispatch/\\d|^downcast/|^duckduckgo|^facebook|^fdm[ /]\\d|^getright/|^gozilla/|^hatena|^hobbit|^hotzonu|^hwcdn/|^jeode/|^jetty/|^jigsaw|^linkdex|^metauri|^microsoft bits|^movabletype|^mozilla/\\d\\.\\d \\(compatible;?\\)$|^mozilla/\\d\\.\\d \\w*$|^navermailapp|^netsurf|^nuclei|^offline explorer|^php|^postman|^postrank|^python|^rank|^read|^reed|^rest|^serf|^snapchat|^space bison|^svn|^swcd |^taringa|^thumbor/|^tumblr/|^user-agent:|^valid|^venus/fedoraplanet|^w3c|^webbandit/|^webcopier|^wget|^whatsapp|^xenu link sleuth|^yahoo|^yandex|^zdm/\\d|^zoom marketplace/|^{{.*}}$|adbeat\\.com|appinsights|archive|ask jeeves/teoma|bit\\.ly/|bluecoat drtr|browsex|burpcollaborator|capture|catch|check|chrome-lighthouse|chromeframe|classifier|cloud|crawl|cryptoapi|dareboost|datanyze|dataprovider|dejaclick|dmbrowser|download|evc-batch/|feed|firephp|freesafeip|gomezagent|headless|httrack|hubspot marketing grader|hydra|ibisbrowser|images|inspect|iplabel|ips-agent|java(?!;)|library|mail\\.ru/|manager|monitor|neustar wpm|nutch|offbyone|optimize|pageburst|parser|perl|phantom|pingdom|powermarks|preview|proxy|ptst[ /]\\d|reader|reputation|resolver|retriever|rexx;|rigor|robot|rss|scan|scrape|server|sogou|sparkler/|speedcurve|spider|splash|statuscake|stumbleupon\\.com|supercleaner|synapse|synthetic|torrent|trace|transcoder|twingly recon|url|virtuoso|wappalyzer|webglance|webkit2png|whatcms/|wordpress|zgrab","i")}catch(e){f=y}return Boolean(e)&&f.test(e)}(navigator.userAgent))throw new Error(`Widget ${this.id} was not initialized because user-agent is a bot`);if(this.initialized)throw new Error(`Widget ${this.id} was already initialized`);if(window.addEventListener("message",this.handleEvents(e,t)),window.addEventListener("resize",b()(this.detectMobile,100)),this.trackActivity(),"embed"===this.config.widget_position){let e=(null===(n=this.config)||void 0===n?void 0:n.element)||null;if("string"==typeof e&&(e=document.getElementById(e),!e))throw new Error(`Element with id: ${e} not found`);null==e||e.appendChild(this.iframe)}else null===(o=window.document.querySelector("body"))||void 0===o||o.appendChild(this.iframe);this.initialized=!0,this.detectMobile()}))}sendEventToIframe(e){var t;this.iframe&&this.iframe.contentWindow?(this.log(`Event to iframe: ${e.type}`,e),e.type===h.SetConfig&&(null===(t=e.data)||void 0===t?void 0:t.element)&&delete e.data.element,this.iframe.contentWindow.postMessage(Object.assign(Object.assign({},e),{type:`${this.id}${e.type}`}),"*")):this.log("Error: Cannot find iframe to send event")}notify(e){this.log(`notify ${e.type}:`,e)}notifyParent(e,t){window.addEventListener("message",(n=>{const o=l(this.id,n);o&&(this.log(`Event from iframe: ${o.type}`,o),o.type===e&&t())}))}openWindow(){this.sendEventToIframe({type:h.Open})}closeWindow(){this.sendEventToIframe({type:h.Close})}sendMessage(e){this.sendEventToIframe({type:h.SendMessage,data:e})}updateContext(e){this.sendEventToIframe({type:h.UpdateContext,data:e})}setCSSVariables(e){this.sendEventToIframe({type:h.SetCssVariables,data:e})}setLocale(e){this.sendEventToIframe({type:h.SetLocale,data:e})}onSessionCreated(e){this.notifyParent(m.SessionCreated,e)}onSessionClosed(e){this.notifyParent(m.SessionClosed,e)}onConversationClosed(e){this.notifyParent(m.ConversationClosed,e)}onSessionReconnected(e){this.notifyParent(m.SessionReconnected,e)}onNoUnreadMessages(e){this.notifyParent(m.ConversationNoUnreadMessages,e)}onUnreadMessages(e){this.notifyParent(m.ConversationUnreadMessages,e)}}var E=n(6186),j=n.n(E),I=n(2155),S=n.n(I),O=n(7433),k=n.n(O),T=n(8626),M=n.n(T),$=n(8990),z=n.n($),U=n(9827),W=n.n(U),L=n(9477),_={};_.styleTagTransform=W(),_.setAttributes=M(),_.insert=k().bind(null,"head"),_.domAPI=S(),_.insertStyleElement=z(),j()(L.A,_),L.A&&L.A.locals&&L.A.locals;let N=t()("moveo:web-client");const R=async e=>{const t=`moveo-${((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))(5)}`,n=window.location.href;if(N=N.extend(`:${t}`),!(null==e?void 0:e.integrationId))throw new Error("integrationId is required.\n Call MoveoAI.init({ integrationId: YOUR_INTEGRATION_HERE })");const o=await(async(e,t)=>{const n=t||c,o=await fetch(`${n}/v1/web/${e}`),i=await o.text();if(o.ok)return JSON.parse(i);throw new Error(`Error loading config from: ${n}/${e}`)})(e.integrationId,e.host);return N("Loaded integration configuration:",o),Object.assign(Object.assign({},a(Object.assign({},o),e)),{clientUrl:n,widgetId:t})},B=async e=>{await new Promise((e=>{if("complete"===document.readyState)return e();window.addEventListener("load",(()=>e()))}));const t=await R(e);if(N("Configuration:",t),"embed"===t.widget_position&&!t.element)throw new Error("element is not defined but required by embed widget");const n=new F(t);N("Initializing");const o=await n.init();return N("Initialized"),o}}(),o}()}));
//# sourceMappingURL=web-client.min.js.map